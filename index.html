<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>æ—¥å¹²æ”¯ checker</title>
<style>
  :root{
    --ink:#333; --brand:#ff68b6;

    /* å…¥åŠ›ï¼ˆå¹´æœˆ/æ—¥ å…±é€šï¼‰ */
    --field-fg:#555;              /* æ–‡å­—è‰²ï¼ˆã‚°ãƒ¬ãƒ¼ç³»ï¼‰ */
    --field-size:16px;            /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º */
    --field-weight:400;           /* å¤ªã• 400ã€œ600 */
    --field-border:#cfd6e0;       /* æ ç·šè‰² */
    --field-radius:8px;           /* è§’ä¸¸ */
    --field-height:38px;          /* ãƒœãƒƒã‚¯ã‚¹é«˜ã•ï¼ˆå¹´æœˆ/æ—¥ å…±é€šï¼‰ */
    --field-pad-x:10px;           /* å·¦å³ã®å†…å´ä½™ç™½ï¼ˆãƒ†ã‚­ã‚¹ãƒˆå´ï¼‰ */
    --caret-color:#7aa8ff;        /* â–¼ã®è‰² */

    /* å¹´æœˆãƒœãƒƒã‚¯ã‚¹ã®è©°ã‚å…·åˆ */
    --ym-gap:6px;                 /* ã€Œå¹´ã€ã€Œæœˆã€é–“ã®éš™é–“ */
    --ym-caret-pad:22px;          /* å³å´ã®â–¼ã¶ã‚“ã®ä½™ç™½ */

    /* çµæœè¡¨ç¤ºã®èª¿æ•´ */
    --res-kanshi-size:26px;       /* ç”²æˆŒãªã© */
    --res-reading-size:12px;      /* ãã®ãˆã„ã¬ */

    /* ã€ˆç”²ğŸŒ³æ¨¹æœ¨ã®äººã€‰ã®èª¿æ•´ï¼ˆâ†ã“ã“ã‚’å¤‰ãˆã‚Œã°OKï¼‰ */
    --persona-size:15px;
    --persona-weight:600;
    --persona-color:#444;

    /* ãƒœã‚¿ãƒ³/OFUSE */
    --nav-btn-bg:#3b66bce2; --nav-btn-fg:#fff;
    --support-offset: 25px;
  }

  html,body{ margin:0; padding:0; height:100%; -webkit-text-size-adjust:100%; color:var(--ink); }
  body{
    font-family:'Hiragino Kaku Gothic ProN', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
    text-align:center;
    background:url('iloiloback.jpg') no-repeat center/cover;
  }
  .wrap{
    min-height:100svh; padding:24px 16px calc(24px + env(safe-area-inset-bottom));
    display:flex; flex-direction:column; justify-content:center; align-items:center; gap:16px;
  }

  /* ä¸¸ã‚«ãƒ¼ãƒ‰ */
  .card{
    background:rgba(255,255,255,.6);
    border-radius:50%;
    width:260px; height:260px;
    box-shadow:0 8px 24px rgba(0,0,0,.1);
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    padding:18px;
  }

  /* ãƒ­ã‚´ & ã‚µãƒ– */
  .logo{
    font-family:'Futura','Avenir Next','Montserrat',sans-serif;
    font-weight:900; font-size:34px; letter-spacing:.02em; margin:0;
  }
  .sub{
    font-family:'Futura','Avenir Next','Montserrat',sans-serif;
    font-weight:400; font-size:17px; margin:2px 0 0;
  }

  /* å…¥åŠ›è¡Œ */
  .row{ display:flex; gap:8px; align-items:center; justify-content:center; margin-top:10px; }

  /* å…±é€šãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åŸºç¤ï¼ˆå¹´æœˆ/æ—¥ï¼‰ */
  .field{
    height:var(--field-height);
    border:1px solid var(--field-border);
    border-radius:var(--field-radius);
    background:#fff;
    font-size:var(--field-size);
    font-weight:var(--field-weight);
    color:var(--field-fg);
    line-height:1;
  }

  /* å¹´æœˆï¼šã²ã¨ç®±ï¼ˆä¸­ã« å¹´ãƒ»æœˆãƒ»â–¼ ã‚’å«ã‚ã‚‹ï¼‰ */
  .ym-box{
    position:relative; display:inline-flex; align-items:center;
    gap:var(--ym-gap);
    padding:0 calc(var(--field-pad-x) + var(--ym-caret-pad)) 0 var(--field-pad-x);
  }
  .ym-year, .ym-month, .ym-suffix{ pointer-events:none; user-select:none; }
  .ym-suffix{ opacity:.9; }
  .ym-caret{
    position:absolute; right:8px; top:50%; transform:translateY(-50%);
    font-size:10px; color:var(--caret-color); pointer-events:none;
  }
  /* ã‚¹ãƒãƒ›ã§ãƒ›ã‚¤ãƒ¼ãƒ«ã‚’ç¢ºå®Ÿã«å‡ºã™ãŸã‚ã€å…¨é¢ã«é€æ˜ month å…¥åŠ› */
  .ym-box input[type="month"]{
    position:absolute; inset:0; width:100%; height:100%;
    opacity:0; border:0; background:transparent; appearance:none; -webkit-appearance:none;
    cursor:pointer;
  }

  /* æ—¥ï¼šãƒœãƒƒã‚¯ã‚¹å†…ã«ã€Œæ—¥ã€ã¨ã€Œâ–¼ã€ã‚’å…¥ã‚Œã‚‹ï¼ˆå¹´æœˆã¨é«˜ã•ï¼†æ–‡å­—æ„Ÿã‚’æƒãˆï¼‰ */
  .day-box{ position:relative; display:inline-block; padding:0 var(--field-pad-x); }
  .day-box select{
    appearance:none; -webkit-appearance:none; outline:none;
    border:0; background:transparent; color:var(--field-fg);
    font-size:var(--field-size); font-weight:var(--field-weight);
    height:100%; padding-right:32px; /* ã€Œæ—¥ã€ã¨â–¼ã®ã‚¹ãƒšãƒ¼ã‚¹ */
  }
  .day-suffix{
    position:absolute; right:22px; top:50%; transform:translateY(-50%);
    font-size:var(--field-size); font-weight:var(--field-weight);
    color:var(--field-fg); pointer-events:none; user-select:none; opacity:.9;
  }
  .day-box::after{
    content:"â–¼"; position:absolute; right:8px; top:50%; transform:translateY(-50%);
    font-size:10px; color:var(--caret-color); pointer-events:none;
  }

  /* çµæœï¼šå¹²æ”¯ã¨èª­ã¿ã‚’è¿‘ã¥ã‘ã‚‹ï¼ˆè©°ã‚æ°—å‘³ï¼‰ */
  .result{ margin-top:10px; font-size:var(--res-kanshi-size); font-weight:700; min-height:30px; }
  .reading{ margin-top:2px; font-size:var(--res-reading-size); color:#444; min-height:16px; }

  /* ã€ˆç”²ğŸŒ³æ¨¹æœ¨ã®äººã€‰ï¼ˆã‚µã‚¤ã‚ºãƒ»å¤ªã•ã‚’å¤‰æ•°ã§èª¿æ•´å¯èƒ½ï¼‰ */
  .persona{
    margin-top:4px;
    font-size:var(--persona-size);
    font-weight:var(--persona-weight);
    color:var(--persona-color);
    min-height:18px;
  }

  /* ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ãƒœã‚¿ãƒ³ï¼ˆä¸¸ã‚«ãƒ¼ãƒ‰ã®å°‘ã—ä¸‹ï¼‰ */
  .nav{ margin-top:4px; }
  .nav .to-calendar{
    text-decoration:none; font-size:14px; font-weight:600;
    background:var(--nav-btn-bg); color:var(--nav-btn-fg);
    padding:8px 14px; border-radius:999px; display:inline-block;
  }

  /* OFUSEå›ºå®šï¼ˆè·é›¢ã¯ --support-offset ã§èª¿æ•´ï¼‰ */
  .support-footer{
    position:fixed; left:0; right:0; bottom:var(--support-offset); z-index:10; text-align:center;
  }
  .support-btn{
    text-decoration:none; font-size:12px; font-weight:600;
    color:#ff7f50; background:transparent; border:2px solid #ff7f50;
    padding:6px 10px; border-radius:10px; display:inline-block; opacity:.9;
  }
  @media (max-width:420px){
    .support-btn{ font-size:11px; padding:5px 9px; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 class="logo">ilo.ilo</h1>
      <div class="sub">æ—¥å¹²æ”¯ checker</div>

      <div class="row">
        <!-- å¹´æœˆï¼šã²ã¨ç®±ï¼ˆã€Œ2025 å¹´  9 æœˆ â–¼ã€ï¼‰ -->
        <span class="field ym-box">
          <span class="ym-year" id="ymYear">----</span>
          <span class="ym-suffix">å¹´</span>
          <span class="ym-month" id="ymMonth">--</span>
          <span class="ym-suffix">æœˆ</span>
          <span class="ym-caret">â–¼</span>
          <input type="month" id="ymInput" />
        </span>

        <!-- æ—¥ï¼šã²ã¨ç®±ï¼ˆã€Œ2 æ—¥ â–¼ã€ï¼‰ -->
        <span class="field day-box">
          <select id="day"></select>
          <span class="day-suffix">æ—¥</span>
        </span>
      </div>

      <!-- è‡ªå‹•æ›´æ–°ï¼šãƒœã‚¿ãƒ³ãªã— -->
      <div class="result" id="result"></div>
      <div class="reading" id="reading"></div>
      <div class="persona" id="persona"></div>
    </div>

    <div class="nav">
      <a class="to-calendar" href="calendar.html" rel="noopener">æ—¥å¹²æ”¯ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸ â†’</a>
    </div>
  </div>

  <div class="support-footer">
    <a class="support-btn" href="https://ofuse.me/izuiloilo" target="_blank" rel="noopener">izuã‚’å¿œæ´ã™ã‚‹</a>
  </div>

<script>
  /* å¹²æ”¯ãƒ‡ãƒ¼ã‚¿ */
  const stems = ["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"];
  const stemsReading = ["ãã®ãˆ","ãã®ã¨","ã²ã®ãˆ","ã²ã®ã¨","ã¤ã¡ã®ãˆ","ã¤ã¡ã®ã¨","ã‹ã®ãˆ","ã‹ã®ã¨","ã¿ãšã®ãˆ","ã¿ãšã®ã¨"];
  const branches = ["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"];
  const branchesReading = ["ã­","ã†ã—","ã¨ã‚‰","ã†","ãŸã¤","ã¿","ã†ã¾","ã²ã¤ã˜","ã•ã‚‹","ã¨ã‚Š","ã„ã¬","ã„"];

  /* åå¹²ã‚­ãƒ£ãƒƒãƒ */
  const stemPersona = {
    "ç”²":"ğŸŒ³æ¨¹æœ¨ã®äºº","ä¹™":"ğŸª»è‰èŠ±ã®äºº","ä¸™":"â˜€ï¸å¤ªé™½ã®äºº","ä¸":"ğŸ”¥ç‚ã®äºº","æˆŠ":"â›°ï¸å±±ã®äºº",
    "å·±":"ğŸŒ±å¤§åœ°ã®äºº","åºš":"ğŸª¨å²©ãƒ»é‰„å¡Šã®äºº","è¾›":"ğŸ’å®çŸ³ã®äºº","å£¬":"ğŸŒŠæµ·ãƒ»å¤§æ²³ã®äºº","ç™¸":"â˜”ï¸é›¨ã®äºº"
  };

  const baseDate  = new Date(1984, 2, 31); // 3/31 ç”²å­
  function kanshiIndexFromDate(date){
    const diffDays = Math.floor((date - baseDate) / (1000*60*60*24));
    return (diffDays % 60 + 60) % 60;
  }

  /* DOM */
  const ymInput = document.getElementById('ymInput');
  const ymYear  = document.getElementById('ymYear');
  const ymMonth = document.getElementById('ymMonth');
  const daySel  = document.getElementById('day');
  const resultEl  = document.getElementById('result');
  const readingEl = document.getElementById('reading');
  const personaEl = document.getElementById('persona');

  /* å†…éƒ¨çŠ¶æ…‹ï¼šå¹´ãƒ»æœˆï¼ˆ1-12ï¼‰ */
  let curYear, curMonth;

  /* æ—¥ã®é¸æŠè‚¢ã‚’æœˆã”ã¨ã«æ›´æ–° */
  function updateDays(){
    const last = new Date(curYear, curMonth, 0).getDate();
    const keep = +daySel.value || 1;
    daySel.innerHTML = '';
    for(let d=1; d<=last; d++){ daySel.add(new Option(d, d)); }
    daySel.value = Math.min(keep, last);
  }

  /* å¹´æœˆãƒ©ãƒ™ãƒ«æ›´æ–°ï¼ˆãƒœãƒƒã‚¯ã‚¹å†…è¡¨ç¤ºï¼‰ */
  function updateYmLabel(){
    ymYear.textContent  = curYear;
    ymMonth.textContent = curMonth;
  }

  /* çµæœã®æ›´æ–°ï¼ˆå¹²æ”¯ãƒ»èª­ã¿ãƒ»ã€ˆç”²ğŸŒ³æ¨¹æœ¨ã®äººã€‰ï¼‰ */
  function updateResult(){
    const d = +daySel.value;
    if(!curYear || !curMonth || !d) return;

    const date = new Date(curYear, curMonth-1, d);
    const idx  = kanshiIndexFromDate(date);

    const stem   = stems[idx%10];
    const branch = branches[idx%12];
    const stemR  = stemsReading[idx%10];
    const branchR= branchesReading[idx%12];

    resultEl.textContent  = stem + branch;              // ç”²æˆŒ
    readingEl.textContent = stemR + branchR;            // ãã®ãˆã„ã¬ï¼ˆâ†ã²ã‚‰ãŒãªOKï¼‰

    const tag = stemPersona[stem] ? `ã€ˆ${stem}${stemPersona[stem]}ã€‰` : "";
    personaEl.textContent = tag;                        // ã€ˆç”²ğŸŒ³æ¨¹æœ¨ã®äººã€‰
  }

  /* iOSã®monthãƒ›ã‚¤ãƒ¼ãƒ«å¯¾å¿œ */
  function supportsMonth(){
    const i = document.createElement('input');
    i.setAttribute('type','month');
    return i.type === 'month';
  }

  /* å¹´æœˆå¤‰æ›´ â†’ è‡ªå‹•æ›´æ–° */
  if(supportsMonth()){
    ymInput.addEventListener('change', ()=>{
      if(!ymInput.value) return; // "YYYY-MM"
      const [y,m] = ymInput.value.split('-').map(v=>+v);
      curYear = y; curMonth = m;
      updateYmLabel(); updateDays(); updateResult();
    });
  }else{
    ymInput.type = 'text';
    ymInput.placeholder = 'YYYY-MM';
    ymInput.addEventListener('change', ()=>{
      const v = ymInput.value.trim();
      const ok = /^\d{4}-(0[1-9]|1[0-2])$/.test(v);
      if(ok){
        const [y,m] = v.split('-').map(v=>+v);
        curYear = y; curMonth = m;
        updateYmLabel(); updateDays(); updateResult();
      }
    });
  }

  /* æ—¥å¤‰æ›´ â†’ è‡ªå‹•æ›´æ–° */
  daySel.addEventListener('change', updateResult);

  /* åˆæœŸï¼šä»Šæ—¥ã§ã‚»ãƒƒãƒˆï¼†å³è¡¨ç¤º */
  (function(){
    const t=new Date();
    curYear  = t.getFullYear();
    curMonth = t.getMonth()+1;
    updateYmLabel();
    if(supportsMonth()){
      ymInput.value = `${curYear}-${String(curMonth).padStart(2,'0')}`;
    }
    for(let d=1; d<=31; d++){ daySel.add(new Option(d, d)); }
    updateDays();
    daySel.value = t.getDate();
    updateResult();   // åˆæœŸè¡¨ç¤º
  })();
</script>
</body>
</html>
