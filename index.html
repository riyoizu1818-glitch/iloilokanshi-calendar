<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>日干支＆calendar</title>
<style>
  :root{ --ink:#333; --brand:#ff68b6; --white:#fff; --blue:#1e90ff; }
  html,body{ margin:0; padding:0; height:100%; -webkit-text-size-adjust:100%; color:var(--ink); }
  body{
    font-family:'Hiragino Kaku Gothic ProN', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
    text-align:center;
    background:url('iloiloback.jpg') no-repeat center/cover;
  }
  .wrap{
    min-height:100svh; padding:24px 16px calc(24px + env(safe-area-inset-bottom));
    display:flex; flex-direction:column; justify-content:center; align-items:center; gap:16px;
  }

  .card{
    background:rgba(255,255,255,.6);
    border-radius:50%;
    width:260px; height:260px;
    box-shadow:0 8px 24px rgba(0,0,0,.1);
    display:flex; flex-direction:column; justify-content:center; align-items:center;
    padding:18px;
  }

  .logo{
    font-family:'Futura','Avenir Next','Montserrat',sans-serif;
    font-weight:900; font-size:34px; letter-spacing:.02em; margin:0;
  }
  .sub{
    font-family:'Futura','Avenir Next','Montserrat',sans-serif;
    font-weight:500; font-size:17px; margin:2px 0 0;
  }

  .row{ display:flex; gap:6px; align-items:center; justify-content:center; margin-top:10px; }
  .sel{ position:relative; display:inline-block; }
  select{
    appearance:none; -webkit-appearance:none; outline:none;
    font-size:16px; color:var(--blue);
    border:1px solid #cfd6e0; background:rgba(255,255,255,.96);
    border-radius:8px; padding:6px 22px 6px 8px; line-height:1.1;
  }
  .sel-year select{ width:82px; }
  .sel-month select, .sel-day select{ width:60px; }
  .sel::after{
    content:"▼"; position:absolute; right:8px; top:50%; transform:translateY(-52%);
    font-size:10px; color:#7aa8ff; pointer-events:none;
  }
  .unit{ font-weight:600; font-size:13px; color:#444; }

  .btn{
    margin-top:10px; padding:12px 22px; font-size:16px; color:#fff; background:var(--brand);
    border:none; border-radius:999px; cursor:pointer; min-height:44px;
  }

  .result{ margin-top:12px; font-size:26px; font-weight:700; min-height:32px; }
  .reading{ margin-top:0; font-size:12px; color:#444; min-height:16px; }

  .support-btn{
    margin-top:6px; text-decoration:none; font-size:14px; font-weight:600;
    color:#ff7f50; background:transparent; border:2px solid #ff7f50;
    padding:8px 14px; border-radius:10px; display:inline-block;
  }

  /* ✅ コピーライト */
  .footer {
    font-size: 11px;
    color: rgba(255,255,255,0.6); /* 薄い白っぽいグレー */
    text-align: center;
    margin-top: 20px;
    padding: 10px;
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 class="logo">ilo.ilo</h1>
      <div class="sub">日干支＆calendar</div>

      <div class="row">
        <span class="sel sel-year"><select id="year"></select></span><span class="unit">年</span>
        <span class="sel sel-month"><select id="month"></select></span><span class="unit">月</span>
        <span class="sel sel-day"><select id="day"></select></span><span class="unit">日</span>
      </div>

      <button class="btn" onclick="calculate()">CHECK!</button>

      <div class="result" id="result"></div>
      <div class="reading" id="reading"></div>
    </div>

    <a class="support-btn" href="https://ofuse.me/izuiloilo" target="_blank" rel="noopener">izuを応援する</a>
  </div>

  <!-- ✅ コピーライト -->
  <footer class="footer">
    © <span id="year"></span> ilo.ilo / izu
  </footer>

<script>
  const stems = ["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"];
  const stemsReading = ["きのえ","きのと","ひのえ","ひのと","つちのえ","つちのと","かのえ","かのと","みずのえ","みずのと"];
  const branches = ["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"];
  const branchesReading = ["ね","うし","とら","う","たつ","み","うま","ひつじ","さる","とり","いぬ","い"];

  const baseDate  = new Date(1984, 2, 31);
  const baseIndex = 0;

  const yearSel  = document.getElementById('year');
  const monthSel = document.getElementById('month');
  const daySel   = document.getElementById('day');

  for(let y=1950; y<=2060; y++){ const o=new Option(y,y); yearSel.add(o); }
  for(let m=1; m<=12; m++){ const o=new Option(m,m); monthSel.add(o); }
  for(let d=1; d<=31; d++){ const o=new Option(d,d); daySel.add(o); }

  function updateDays(){
    const y = +yearSel.value, m = +monthSel.value;
    const last = new Date(y, m, 0).getDate();
    const keep = +daySel.value || 1;
    daySel.innerHTML='';
    for(let d=1; d<=last; d++){ daySel.add(new Option(d,d)); }
    daySel.value = Math.min(keep, last);
  }

  function kanshiIndexFromDate(date){
    const diffDays = Math.floor((date - baseDate) / (1000*60*60*24));
    return (baseIndex + (diffDays % 60) + 60) % 60;
  }

  function calculate(){
    const y = +yearSel.value, m = +monthSel.value, d = +daySel.value;
    if(!y || !m || !d) return;
    const date = new Date(y, m-1, d);
    const idx  = kanshiIndexFromDate(date);
    const stem=stems[idx%10], branch=branches[idx%12];
    const stemR=stemsReading[idx%10], branchR=branchesReading[idx%12];
    document.getElementById('result').textContent  = stem + branch;
    document.getElementById('reading').textContent = stemR + branchR;
  }

  // ✅ 初期表示：今日を選んで結果も表示
  (function(){
    const t=new Date();
    yearSel.value=Math.min(Math.max(t.getFullYear(),1950),2060);
    monthSel.value=t.getMonth()+1;
    updateDays();
    daySel.value=t.getDate();
    calculate();
    // コピーライトの年号自動更新
    document.getElementById("year").textContent = t.getFullYear();
  })();

  yearSel.addEventListener('change', updateDays);
  monthSel.addEventListener('change', updateDays);
</script>
</body>
</html>
